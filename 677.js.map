{"version":3,"file":"677.js","mappings":"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","sources":["webpack://hot-projects-webpack/./src/component/IconFont.js","webpack://hot-projects-webpack/./src/page/Popular/index.scss?7bcd","webpack://hot-projects-webpack/./src/hooks/useTouchBottom.js","webpack://hot-projects-webpack/./src/page/Popular/index.jsx","webpack://hot-projects-webpack/./src/asset/loading.gif"],"sourcesContent":["import * as React from \"react\";\n\n// eslint-disable-next-line react/prop-types\nfunction IconFont({ id, className }) {\n  return (\n    <svg\n      className={`icon ${className}`}\n      width=\"1em\"\n      height=\"1em\"\n      fill=\"currentColor\"\n      overflow=\"hidden\"\n      aria-hidden=\"true\"\n    >\n      <use href={`#${id}`} />\n    </svg>\n  );\n}\n\nexport default IconFont;\n","// extracted by mini-css-extract-plugin\nexport default {\"popular\":\"popular_nJH_R\",\"popularMenu\":\"popularMenu_WUCvf\",\"popularMenuItem\":\"popularMenuItem_fyqnv\",\"active\":\"active_mlneS\",\"popularContent\":\"popularContent_dBaRu\",\"popularContentItem\":\"popularContentItem_AD0_K\",\"itemIndex\":\"itemIndex_mR0Nq\",\"itemImageLazy\":\"itemImageLazy__CxsX\",\"itemImage\":\"itemImage_YZAwU\",\"itemFullName\":\"itemFullName_HpqWz\",\"itemText\":\"itemText_YvXiH\",\"itemTextChild\":\"itemTextChild_K8KjC\",\"icon\":\"icon_ykDQ6\",\"iconFont\":\"iconFont_vRyZq\",\"iconAccount\":\"iconAccount_ID3IC\",\"iconStart\":\"iconStart_Mbs0l\",\"iconFork\":\"iconFork_rRl0s\",\"iconIssues\":\"iconIssues__AZ9m\",\"itemTextInfo\":\"itemTextInfo_ygvWk\",\"itemName\":\"itemName_cytqc\",\"loading\":\"loading_Yl3Qc\"};","import { useEffect } from \"react\";\nimport { throttle } from \"lodash\";\n\nconst isTouchBottom = (callBack) => {\n  // 文档显示区域高度\n  const showHeight = window.innerHeight;\n  // 网页卷曲高度\n  const scrollTopHeight =\n    document.body.scrollTop || document.documentElement.scrollTop;\n  // 所有内容高度\n  const allHeight = document.body.scrollHeight;\n  if (allHeight <= showHeight + scrollTopHeight + 100) {\n    callBack();\n  }\n};\n\nconst useTouchBottom = (callBack) => {\n  const handleCallBack = throttle(() => {\n    if (typeof callBack === \"function\") {\n      isTouchBottom(callBack);\n    }\n  }, 500);\n\n  useEffect(() => {\n    window.addEventListener(\"scroll\", handleCallBack);\n    return () => {\n      window.removeEventListener(\"scroll\", handleCallBack);\n    };\n  }, []);\n};\n\nexport default useTouchBottom;\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { Spin, message } from \"antd\";\nimport axios from \"axios\";\nimport LazyLoad from \"react-lazyload\";\nimport styles from \"./index.scss\";\nimport IconFont from \"@/component/IconFont\";\nimport loadingImg from \"@/asset/loading.gif\";\nimport useTouchBottom from \"@/hooks/useTouchBottom\";\n\nconst tabType = {\n  All: \"All\",\n  JavaScript: \"JavaScript\",\n  Ruby: \"Ruby\",\n  Java: \"Java\",\n  CSS: \"CSS\",\n};\n\nconst PopularPage = () => {\n  const _tab = sessionStorage.getItem(\"popularTab\");\n  const [tab, setTab] = useState(_tab !== null ? _tab : tabType.All);\n  const [tableData, setTableData] = useState([]);\n  const [page, setPage] = useState(1);\n  const [loading, setLoading] = useState(false);\n  const pageRef = useRef(1);\n  const loadingRef = useRef(false);\n  const tableDataRef = useRef([]);\n\n  useEffect(() => {\n    pageRef.current = page;\n    addNews();\n  }, [page, tab]);\n\n  useEffect(() => {\n    tableDataRef.current = tableData;\n  }, [tableData]);\n\n  useEffect(() => {\n    loadingRef.current = loading;\n  }, [loading]);\n\n  // 切换tab\n  const changeTab = (tab) => {\n    if (loading) {\n      return;\n    }\n    pageRef.current = 1;\n    loadingRef.current = false;\n    tableDataRef.current = [];\n    setTab(tab);\n    sessionStorage.setItem(\"popularTab\", tab);\n    setTableData([]);\n    setLoading(false);\n    setPage(1);\n  };\n\n  // 添加列表\n  const addNews = async function () {\n    if (loading) {\n      return;\n    }\n    setLoading(true);\n    const qType = {\n      All: \"\",\n      JavaScript: \"language:javascript\",\n      Ruby: \"language:ruby\",\n      Java: \"language:java\",\n      CSS: \"language:css\",\n    };\n    try {\n      const reason = await axios({\n        method: \"get\",\n        url: \"https://api.github.com/search/repositories\",\n        params: {\n          page: pageRef.current,\n          q: \"stars:>1 \" + qType[tab],\n          sort: \"stars\",\n          order: \"desc\",\n          type: \"Repositories\",\n        },\n      });\n      let _tableData = tableDataRef.current;\n      _tableData = _tableData.concat(reason.data.items);\n      setLoading(false);\n      setTableData(_tableData);\n    } catch (e) {\n      message.error(e?.response?.data?.message);\n    }\n  };\n\n  //渲染菜单\n  const renderMenu = () => {\n    let renderMenuList = [];\n    for (let innertype in tabType) {\n      renderMenuList.push(\n        <div\n          onClick={() => {\n            changeTab(innertype);\n          }}\n          className={`${styles.popularMenuItem} ${\n            tab === innertype && styles.active\n          }`}\n          key={innertype}\n        >\n          {innertype}\n        </div>\n      );\n    }\n    return renderMenuList;\n  };\n\n  //无限加载\n  useTouchBottom(() => {\n    setPage(pageRef.current + 1);\n  });\n\n  // 根据tableData渲染列表数据\n  const renderTableItem = () => {\n    return tableData.map((item, index) => {\n      return (\n        <div className={styles.popularContentItem} key={index}>\n          <div className={styles.itemIndex}>#{index + 1}</div>\n          <LazyLoad\n            className={styles.itemImageLazy}\n            placeholder={\n              <img\n                className={styles.itemImage}\n                src={loadingImg}\n                alt={item.owner.login}\n              />\n            }\n          >\n            <img\n              className={styles.itemImage}\n              src={item.owner.avatar_url}\n              alt={item.owner.login}\n            />\n          </LazyLoad>\n          <a\n            className={styles.itemFullName}\n            href={item.clone_url}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            {item.full_name}\n          </a>\n          <div className={styles.itemText}>\n            {/* 账号account */}\n            <div className={styles.itemTextChild}>\n              <div className={styles.icon}>\n                <IconFont className={styles.iconAccount} id=\"icon-account\" />\n              </div>\n              <a\n                className={`${styles.itemName} ${styles.itemTextInfo}`}\n                href={item.clone_url}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                {item.full_name}\n              </a>\n            </div>\n            {/* 有多少start */}\n            <div className={styles.itemTextChild}>\n              <div className={styles.icon}>\n                <IconFont className={styles.iconStart} id=\"icon-start\" />\n              </div>\n              <div className={styles.itemTextInfo}>\n                {item.stargazers_count} stars\n              </div>\n            </div>\n            {/* 有多少fork */}\n            <div className={styles.itemTextChild}>\n              <div className={styles.icon}>\n                <IconFont className={styles.iconFork} id=\"icon-fork\" />\n              </div>\n              <div className={styles.itemTextInfo}>{item.forks} forks</div>\n            </div>\n            {/* 有多少issue */}\n            <div className={styles.itemTextChild}>\n              <div className={styles.icon}>\n                <IconFont className={styles.iconIssues} id=\"icon-issues\" />\n              </div>\n              <div className={styles.itemTextInfo}>\n                {item.open_issues_count} Open issues\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    });\n  };\n\n  return (\n    <div className={styles.popular}>\n      <div className={styles.popularMenu}>{renderMenu()}</div>\n      <div className={styles.popularContent}>{renderTableItem()}</div>\n      {\n        <Spin>\n          <div className={styles.loading}></div>\n        </Spin>\n      }\n    </div>\n  );\n};\n\nexport default PopularPage;\n","export default __webpack_public_path__ + \"images/loading.gif\";"],"names":["id","className","width","height","fill","overflow","href","callBack","handleCallBack","throttle","showHeight","window","innerHeight","scrollTopHeight","document","body","scrollTop","documentElement","scrollHeight","isTouchBottom","useEffect","addEventListener","removeEventListener","tabType","All","JavaScript","Ruby","Java","CSS","_tab","sessionStorage","getItem","tab","setTab","useState","tableData","setTableData","page","setPage","loading","setLoading","pageRef","useRef","loadingRef","tableDataRef","current","addNews","changeTab","setItem","async","qType","reason","axios","method","url","params","q","sort","order","type","_tableData","concat","data","items","e","message","response","useTouchBottom","styles","renderMenuList","innertype","push","onClick","key","renderMenu","map","item","index","placeholder","src","loadingImg","alt","owner","login","avatar_url","clone_url","target","rel","full_name","IconFont","stargazers_count","forks","open_issues_count"],"sourceRoot":""}